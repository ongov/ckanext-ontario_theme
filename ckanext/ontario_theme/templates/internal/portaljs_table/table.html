
{% extends "page.html" %}

{% block styles %}
  {{ super() }}
  <style>
    /* Scope PortalJS table to avoid CKAN/Bootstrap global overrides */
    .portaljs-table-container {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.4;
      box-sizing: border-box;
    }
    .portaljs-table-container *, .portaljs-table-container *::before, .portaljs-table-container *::after {
      box-sizing: inherit;
    }
    .portaljs-table-container {
      max-width: 100%;
      overflow-x: auto;
      padding: 0.5rem 0;
    }
  </style>
{% endblock %}

{% block primary %}
  <div class="container portaljs-table-container">
    <h1 class="page-heading">PortalJS Table</h1>
    <div id="portaljs-table-root" data-csv-url="{{ csv_url|e }}"></div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script type="module">
    import React from "https://esm.sh/react@18";
    import { createRoot } from "https://esm.sh/react-dom@18/client";
    import { FlatUiTable } from "https://esm.sh/@portaljs/components@0.1.3";

    const mountNode = document.getElementById('portaljs-table-root');
    const csvUrl = mountNode?.getAttribute('data-csv-url') || '';

    if (mountNode && csvUrl) {
      createRoot(mountNode).render(
        React.createElement(FlatUiTable, { url: csvUrl })
      );
    } else {
      console.error("PortalJS Table: missing mount node or csv_url.");
    }
  </script>
{% endblock %}
